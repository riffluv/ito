<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aæ¡ˆ: Pixi.jså¼·åŒ–ç‰ˆ - ãƒ‰ãƒ©ã‚¯ã‚¨Ã—ã‚ªã‚¯ãƒˆãƒ‘èƒŒæ™¯</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.3.2/pixi.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: monospace;
      overflow: hidden;
      background: #000;
    }

    #canvas-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
    }

    .ui-overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      background: rgba(8, 9, 15, 0.92);
      border: 3px solid rgba(255, 255, 255, 0.9);
      padding: 40px;
      color: white;
      text-align: center;
      box-shadow:
        0 0 30px rgba(255, 215, 0, 0.3),
        inset 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .ui-overlay h1 {
      font-size: 2rem;
      margin-bottom: 20px;
      text-shadow: 2px 2px 0px #000, 0 0 10px rgba(255, 215, 0, 0.5);
      letter-spacing: 0.05em;
    }

    .ui-overlay p {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.6;
    }

    .controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 10;
      background: rgba(8, 9, 15, 0.9);
      border: 2px solid rgba(255, 255, 255, 0.6);
      padding: 15px;
      color: white;
      font-size: 12px;
    }

    .controls button {
      display: block;
      width: 100%;
      margin: 5px 0;
      padding: 8px;
      background: rgba(255, 215, 0, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.4);
      color: white;
      font-family: monospace;
      cursor: pointer;
      transition: all 0.2s;
    }

    .controls button:hover {
      background: rgba(255, 215, 0, 0.4);
      border-color: rgba(255, 255, 255, 0.9);
    }

    .controls button.active {
      background: #FFD700;
      color: black;
      border-color: white;
    }
  </style>
</head>
<body>
  <div id="canvas-container"></div>

  <div class="ui-overlay">
    <h1>Aæ¡ˆ: Pixi.jså¼·åŒ–ç‰ˆ</h1>
    <p>
      ã‚­ãƒ©ã‚­ãƒ©å…‰ç²’å­ + ã‚ªãƒ¼ãƒ­ãƒ©æ³¢ + æ˜Ÿã®ã‚†ã‚‰ã<br>
      ãƒ‰ãƒ©ã‚¯ã‚¨ã®ãƒ¬ãƒˆãƒ­æ„Ÿ Ã— ã‚ªã‚¯ãƒˆãƒ‘ã®å¹»æƒ³æ„Ÿ<br>
      <br>
      <strong>ç‰¹å¾´:</strong> è»½é‡ãƒ»ã‹ã‚ã„ã„ãƒ»æš–ã‹ã¿ã®ã‚ã‚‹æ¼”å‡º
    </p>
  </div>

  <div class="controls">
    <strong>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåˆ‡æ›¿:</strong>
    <button onclick="toggleSparkles()" id="btn-sparkles" class="active">âœ¨ ã‚­ãƒ©ã‚­ãƒ©å…‰ç²’å­</button>
    <button onclick="toggleStars()" id="btn-stars" class="active">ğŸŒŸ æ˜Ÿç©ºã®ã‚†ã‚‰ã</button>
    <button onclick="toggleAurora()" id="btn-aurora" class="active">ğŸ’« ã‚ªãƒ¼ãƒ­ãƒ©æ³¢</button>
    <button onclick="toggleLeaves()" id="btn-leaves" class="active">ğŸƒ é¢¨ã®è‘‰ã£ã±</button>
  </div>

  <script>
    // Pixi.js ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    const app = new PIXI.Application({
      width: window.innerWidth,
      height: window.innerHeight,
      backgroundColor: 0x1a0f2e, // æ·±ã„ç´«ï¼ˆå¤•æš®ã‚Œæ„Ÿï¼‰
      antialias: true,
      resolution: window.devicePixelRatio || 1,
    });

    document.getElementById('canvas-container').appendChild(app.view);

    // ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
    window.addEventListener('resize', () => {
      app.renderer.resize(window.innerWidth, window.innerHeight);
    });

    // ===== èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ‰ãƒ©ã‚¯ã‚¨Ã—ã‚ªã‚¯ãƒˆé¢¨ï¼‰ =====
    const bgGradient = new PIXI.Graphics();
    function drawBgGradient() {
      bgGradient.clear();
      const colors = [
        { color: 0x1a0f2e, alpha: 1, position: 0 },      // æ·±ç´«ï¼ˆä¸Šï¼‰
        { color: 0x3d2463, alpha: 1, position: 0.3 },    // ç´«
        { color: 0x5a3a7a, alpha: 1, position: 0.5 },    // æ˜ã‚‹ã„ç´«
        { color: 0x8b5a3c, alpha: 1, position: 0.7 },    // èŒ¶è‰²ï¼ˆåœ°å¹³ç·šï¼‰
        { color: 0xa67c52, alpha: 1, position: 1 },      // æš–è‰²ï¼ˆä¸‹ï¼‰
      ];

      for (let i = 0; i < app.screen.height; i++) {
        const ratio = i / app.screen.height;
        let color = 0x1a0f2e;

        for (let j = 0; j < colors.length - 1; j++) {
          if (ratio >= colors[j].position && ratio <= colors[j + 1].position) {
            const localRatio = (ratio - colors[j].position) / (colors[j + 1].position - colors[j].position);
            color = PIXI.utils.rgb2hex([
              ((colors[j].color >> 16) & 0xFF) * (1 - localRatio) / 255 + ((colors[j + 1].color >> 16) & 0xFF) * localRatio / 255,
              ((colors[j].color >> 8) & 0xFF) * (1 - localRatio) / 255 + ((colors[j + 1].color >> 8) & 0xFF) * localRatio / 255,
              (colors[j].color & 0xFF) * (1 - localRatio) / 255 + (colors[j + 1].color & 0xFF) * localRatio / 255,
            ]);
          }
        }

        bgGradient.beginFill(color);
        bgGradient.drawRect(0, i, app.screen.width, 1);
        bgGradient.endFill();
      }
    }
    drawBgGradient();
    app.stage.addChild(bgGradient);

    window.addEventListener('resize', drawBgGradient);

    // ===== 1. ã‚­ãƒ©ã‚­ãƒ©å…‰ç²’å­ï¼ˆã‚¹ãƒ©ã‚¤ãƒ çš„ï¼‰ =====
    const sparklesContainer = new PIXI.Container();
    app.stage.addChild(sparklesContainer);

    const sparkles = [];
    for (let i = 0; i < 80; i++) {
      const sparkle = new PIXI.Graphics();
      const size = Math.random() * 3 + 1;
      sparkle.beginFill(0xFFD700, Math.random() * 0.6 + 0.4);
      sparkle.drawCircle(0, 0, size);
      sparkle.endFill();

      sparkle.x = Math.random() * app.screen.width;
      sparkle.y = Math.random() * app.screen.height;
      sparkle.vx = (Math.random() - 0.5) * 0.5;
      sparkle.vy = (Math.random() - 0.5) * 0.5;
      sparkle.life = Math.random() * Math.PI * 2;
      sparkle.speed = Math.random() * 0.02 + 0.01;

      sparkles.push(sparkle);
      sparklesContainer.addChild(sparkle);
    }

    // ===== 2. æ˜Ÿç©ºã®ã‚†ã‚‰ã =====
    const starsContainer = new PIXI.Container();
    app.stage.addChild(starsContainer);

    const stars = [];
    for (let i = 0; i < 120; i++) {
      const star = new PIXI.Graphics();
      const size = Math.random() * 2 + 0.5;
      star.beginFill(0xFFFFFF, Math.random() * 0.8 + 0.2);
      star.drawCircle(0, 0, size);
      star.endFill();

      star.x = Math.random() * app.screen.width;
      star.y = Math.random() * app.screen.height * 0.6; // ä¸ŠåŠåˆ†ã ã‘
      star.alpha = Math.random() * 0.7 + 0.3;
      star.baseAlpha = star.alpha;
      star.twinkleSpeed = Math.random() * 0.02 + 0.005;
      star.twinklePhase = Math.random() * Math.PI * 2;

      stars.push(star);
      starsContainer.addChild(star);
    }

    // ===== 3. ã‚ªãƒ¼ãƒ­ãƒ©æ³¢ =====
    const auroraContainer = new PIXI.Container();
    app.stage.addChild(auroraContainer);

    const aurora = new PIXI.Graphics();
    auroraContainer.addChild(aurora);
    let auroraPhase = 0;

    function drawAurora() {
      aurora.clear();

      const colors = [0x4169E1, 0x9370DB, 0xFF69B4, 0xFFD700];
      const waves = 3;

      for (let w = 0; w < waves; w++) {
        aurora.beginFill(colors[w % colors.length], 0.08);
        aurora.moveTo(0, app.screen.height * 0.3 + w * 50);

        for (let x = 0; x <= app.screen.width; x += 20) {
          const y = app.screen.height * 0.3 + w * 50 + Math.sin((x * 0.01 + auroraPhase + w * 0.5)) * 40;
          aurora.lineTo(x, y);
        }

        aurora.lineTo(app.screen.width, app.screen.height);
        aurora.lineTo(0, app.screen.height);
        aurora.endFill();
      }

      auroraPhase += 0.02;
    }

    // ===== 4. é¢¨ã§æºã‚Œã‚‹è‘‰ã£ã± =====
    const leavesContainer = new PIXI.Container();
    app.stage.addChild(leavesContainer);

    const leaves = [];
    for (let i = 0; i < 30; i++) {
      const leaf = new PIXI.Graphics();
      const size = Math.random() * 4 + 2;
      leaf.beginFill(0x90EE90, Math.random() * 0.4 + 0.3);
      leaf.drawEllipse(0, 0, size, size * 1.5);
      leaf.endFill();

      leaf.x = Math.random() * app.screen.width;
      leaf.y = Math.random() * app.screen.height * 0.5;
      leaf.vx = (Math.random() - 0.3) * 1.5;
      leaf.vy = Math.random() * 0.5 + 0.3;
      leaf.rotation = Math.random() * Math.PI * 2;
      leaf.rotationSpeed = (Math.random() - 0.5) * 0.05;

      leaves.push(leaf);
      leavesContainer.addChild(leaf);
    }

    // ===== ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ— =====
    app.ticker.add(() => {
      // ã‚­ãƒ©ã‚­ãƒ©å…‰ç²’å­
      sparkles.forEach(sparkle => {
        sparkle.x += sparkle.vx;
        sparkle.y += sparkle.vy;
        sparkle.life += sparkle.speed;
        sparkle.alpha = (Math.sin(sparkle.life) + 1) / 2 * 0.7 + 0.3;

        // ç”»é¢å¤–ã«å‡ºãŸã‚‰åå¯¾å´ã‹ã‚‰
        if (sparkle.x < 0) sparkle.x = app.screen.width;
        if (sparkle.x > app.screen.width) sparkle.x = 0;
        if (sparkle.y < 0) sparkle.y = app.screen.height;
        if (sparkle.y > app.screen.height) sparkle.y = 0;
      });

      // æ˜Ÿã®ã‚†ã‚‰ã
      stars.forEach(star => {
        star.twinklePhase += star.twinkleSpeed;
        star.alpha = star.baseAlpha + Math.sin(star.twinklePhase) * 0.3;
      });

      // ã‚ªãƒ¼ãƒ­ãƒ©æ³¢
      drawAurora();

      // è‘‰ã£ã±
      leaves.forEach(leaf => {
        leaf.x += leaf.vx;
        leaf.y += leaf.vy;
        leaf.rotation += leaf.rotationSpeed;

        // ç”»é¢å¤–ã«å‡ºãŸã‚‰ä¸Šã‹ã‚‰å†å‡ºç¾
        if (leaf.x < -10) leaf.x = app.screen.width + 10;
        if (leaf.x > app.screen.width + 10) leaf.x = -10;
        if (leaf.y > app.screen.height + 10) {
          leaf.y = -10;
          leaf.x = Math.random() * app.screen.width;
        }
      });
    });

    // ===== ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåˆ‡æ›¿ =====
    let effectsState = {
      sparkles: true,
      stars: true,
      aurora: true,
      leaves: true,
    };

    function toggleSparkles() {
      effectsState.sparkles = !effectsState.sparkles;
      sparklesContainer.visible = effectsState.sparkles;
      document.getElementById('btn-sparkles').classList.toggle('active');
    }

    function toggleStars() {
      effectsState.stars = !effectsState.stars;
      starsContainer.visible = effectsState.stars;
      document.getElementById('btn-stars').classList.toggle('active');
    }

    function toggleAurora() {
      effectsState.aurora = !effectsState.aurora;
      auroraContainer.visible = effectsState.aurora;
      document.getElementById('btn-aurora').classList.toggle('active');
    }

    function toggleLeaves() {
      effectsState.leaves = !effectsState.leaves;
      leavesContainer.visible = effectsState.leaves;
      document.getElementById('btn-leaves').classList.toggle('active');
    }
  </script>
</body>
</html>
