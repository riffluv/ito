## 序の紋章III "据え置きゲーム感" 向上計画（ドラフト）

※ 開発者メモ兼たたき台です。あとでいくらでも書き換えてOK。眉唾に見えるところも、実際に試してから残す / 捨てる前提。

---

## 1. ゴールと前提

- ゴール
  - フルスクリーンで遊んだときに「ブラウザゲー」ではなく **据え置きタイトル風のゲーム画面** に感じてもらう。
  - 入力 → 演出 → 結果表示までの **手触り（レスポンス）** を、コンシューマー機のテンポに近づける。

- 技術前提
  - Next.js 14 / React / Chakra UI
  - Pixi.js 8 + GSAP 3（背景 & HUD）
  - HD-2D 風の背景設計（`ThreeBackground` 周り）
  - 代表例: `components/ui/StreakBanner.tsx` の連勝カットイン演出

---

## 2. 優先度の考え方

「据え置き感」を上げるために、まず **プレイ感に直結するところ** から手を入れていく。

1. レスポンス（押した瞬間のリアクション）
2. モーションルール（動き方の統一）
3. カメラショット風レイアウト（見せ場の作り方）
4. ライティング＆色の一貫性
5. ベイク済み VFX（Flipbook 等）
6. パフォーマンス & サウンドの微調整

以下、それぞれ「どんな効果があるか」と「Before / After イメージ」をメモしておく。

---

## 3. レスポンス設計（優先度: 最優先）

### 狙い

- ボタンやカードを **押した瞬間にゲームが反応してくれる** ことで、「キビキビ動く」「入力が通っている」感覚を出す。
- ネットワークや処理が多少重くても、**体感としてはサクサク** に感じさせる。

### やることの例

- 主要ボタン（決定・提出・リトライなど）
  - 押下直後に即座に `scale` / `shadow` / `color` を変化させる（100ms 以内）。
  - サーバー応答待ちの間は、ボタンを押し込まれた状態＋軽いパルスで「処理中」を伝える。
- キーボードショートカット
  - `useClueInput` などの入力系で、押したフレームで **見た目だけでも反応** させる（フォーカス移動を待たない）。

### Before / After

- Before
  - ボタンを押す → 見た目は何も変わらない → 数百 ms 後に画面だけ切り替わる。
  - 「押せたのか？」「ラグってる？」という不安が残る。
- After
  - 押した瞬間にボタンが 0.9 倍に縮む・光る・軽く音が鳴る。
  - その後に画面が切り替わるので、多少待っても「ちゃんと動いてる」と感じられる。

---

## 4. モーションルールの統一（優先度: 高）

### 狙い

- 画面内のあらゆる UI や演出を「同じ世界のキャラクター」のように動かす。
- 有名タイトルの UI がなんとなく気持ちよく感じるのは、**秒数とイージングが徹底されている** ため。

### 基本ルールの案

- 登場アニメーション
  - 時間: 200〜280ms
  - イージング: `power3.out` / `back.out(1.4)`
  - 少しオーバーシュートしてから落ち着く（例: StreakBanner の数字）。
- 退場アニメーション
  - 時間: 320〜450ms
  - イージング: `power2.in`
  - 上方向 or 奥方向に抜けていく（Fade + Move）。
- 優先度別のパターン（2〜3種類に限定）
  - 通常 UI: 速め・オーバーシュート少なめ。
  - 重要演出: やや長め・オーバーシュート強め。

### Before / After

- Before
  - コンポーネントごとに秒数・イージングがバラバラで、「なんとなく」違う動き方をしている。
- After
  - 「登場はこの速さ・このイージング」「退場はこのパターン」という共通ルールがあり、
    どの画面にいても **“序の紋章の動き方”** に感じられる。

---

## 5. カメラショット風レイアウト（優先度: 中〜高）

### 狙い

- 画面の「主役」と「脇役」をハッキリさせて、TV ゲームのような **カメラショット** を作る。
- 勝利・連勝・結果画面などで **見せ場を一瞬作る** ことで、印象に残る演出にする。

### やることの例

- プレイエリア
  - 中央に 16:9 を意識した「主役エリア」を置く。
  - 重要演出中は、このエリア以外の UI を少し暗くする・小さくする。
- カメラっぽい動き
  - 勝利や連勝時に HUD 全体（Pixi HUD root）を 1.02〜1.05 倍にズーム & わずかにパンする。
  - 時間は 200〜300ms 程度で軽く。「やり過ぎ映画」にはしない。

### Before / After

- Before
  - 画面のどこを見ても同じような情報密度で、「Web アプリの画面」がただ切り替わるだけ。
- After
  - 勝利時には画面が少し寄り、中央に光が集まり、他の UI が一歩下がる。
  - 「今ここがクライマックスだ」と **視覚的に伝わる**。

---

## 6. ライティング & カラーの一貫性（優先度: 中）

### 狙い

- 背景・カード・ボタン・文字の **光源と影の方向を揃える**。
- 全体を一枚の絵として見たときに、バラバラなコンポーネントの集合ではなく「ゲーム画面」に見せる。

### やることの例

- 光源の設定
  - 仮に「右上からキーライト」「左下に影」など、ざっくり方向を決める。
  - Shadow / Glow の方向・色味をそこに寄せる。
- トーン調整
  - Pixi の ColorMatrixFilter で、全体をほんの少しだけフィルムトーンに寄せる（輝度 -3%、彩度 +5% 程度）。
  - 勝利演出など盛りたい瞬間だけ Bloom を 0.2〜0.3 秒だけ強めにする。

### Before / After

- Before
  - 背景は青っぽい、カードは黄色っぽい、ボタンの影方向もまちまちで、どことなく「Web UI を重ねた」印象。
- After
  - 光の色・影の方向が揃い、演出時には画面全体が一瞬だけ明るくなってすぐ戻る。
  - フルスクリーンで見たときに **一枚絵としてまとまって見える**。

---

## 7. ベイク済み VFX（Flipbook 等）（優先度: 中〜低、ただし効果大）

### 狙い

- 炎・光・爆散・稲妻など、「ブラウザの CSS アニメでは出しづらい」動きを専用 VFX に任せる。
- リッチな見た目を持ちつつ、WebGL では **軽く再生するだけ** にする。

### やることの例

- 外部ツール（Houdini / Blender など）で短い VFX を作成
  - 例: 光の爆発、光条、粒子の散り散り。
  - 8〜12 フレーム程度の Flipbook（スプライトシート）として書き出す。
- Pixi 側
  - `AnimatedSprite` で再生し、GSAP で位置・スケール・アルファのみ制御。
  - 重要演出（連勝・勝利・ハイライト）にだけ差し込む。

### Before / After

- Before
  - フェードとスケールインだけで、演出の「密度」が少し物足りない。
- After
  - 勝利・連勝の瞬間に、滑らかな光の爆散や稲妻が 0.4 秒だけ走り、「ゲーム専用のエフェクト」感が出る。

---

## 8. パフォーマンス & サウンド（優先度: 中）

### 狙い

- 60fps 付近の安定感をキープしつつ、「重さを感じさせない」設計にする。
- 音で演出に重みと手応えを足す。

### やることの例

- パフォーマンス
  - 同時スプライト数・フィルタ数の目安を決めておき、超えそうなシーンを避ける。
  - 重い VFX は「事前ベイク + 軽い合成」に寄せる。
- サウンド
  - キーハイライト（勝利・連勝・失敗など）には、低めの SE を薄く足して「手応え」を出す。
  - 入力 → 動き → 音 の順で気持ちよく揃うように調整する。

### Before / After

- Before
  - 演出によって fps が揺れ、時々「ガクッ」と止まる → それだけで Web 感が強まる。
- After
  - 演出の派手さを保ちつつ fps のブレを抑え、「一定のテンポ」で動き続ける → コンシューマーライクな安定感が出る。

---

## 9. 今後の進め方メモ

1. まずは **レスポンス** と **モーションルール** を、既存 UI（ボタン・StreakBanner・結果オーバーレイなど）に適用してみる。
2. そのうえで、余力を見ながら **カメラショット風レイアウト** と **ライティング統一** を進める。
3. 最後に、余裕があれば **Flipbook VFX** や **ColorMatrix/Bloom** で「最終仕上げ」を足す。

実際に触った体感をもとに、このドキュメントはどんどん書き換えていってOK。
