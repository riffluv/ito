Follow FSM-first architecture: components obtain state via `useRoomState` and XState events, no legacy fallbacks. Firestore/RTDB writes must go through `lib/game/service.ts`; presence logic relies solely on RTDB (`useParticipants` with `presenceReady`). Pixi/GSAP animations need explicit cleanup and respect reduced-motion settings. Errors should emit `traceAction`/`traceError` so telemetry stays consistent. Avoid direct Pixi HUD/background mixingâ€”use `ThreeBackground` or `usePixiHudLayer`. Tests cover shortcuts and room flow (Jest + Playwright), so keep logic testable. React StrictMode is disabled in dev to avoid Pixi/GSAP double-render issues; no need to re-enable.