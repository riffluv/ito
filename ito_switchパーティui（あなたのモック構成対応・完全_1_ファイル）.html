<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ITO – Switch Party UI（Mock構成対応）</title>
<style>
  :root{
    --bg1:#0f121a;--bg2:#131a22;--accent:#ff5d57;--accent2:#ffd166;--mint:#30e3ca;--blue:#59a5ff;--vio:#9b6cff;--muted:#cfd7e6;--glass:rgba(255,255,255,.06);--glass2:rgba(255,255,255,.14);--shadow:0 12px 26px rgba(0,0,0,.36),0 3px 8px rgba(0,0,0,.25);--radius:22px
  }
  html,body{height:100%}
  body{margin:0;color:#f6f8ff;font-family:ui-rounded,system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic UI","Yu Gothic",Meiryo,sans-serif;background:
    radial-gradient(1300px 900px at 85% -10%, rgba(255,93,87,.35), transparent 65%),
    radial-gradient(1200px 800px at 10% -15%, rgba(48,227,202,.35), transparent 60%),
    radial-gradient(1500px 900px at 50% 120%, rgba(89,165,255,.35), transparent 65%),
    linear-gradient(180deg,var(--bg1),var(--bg2));overflow:hidden}
  .blob{position:absolute;filter:blur(44px);opacity:.6;pointer-events:none}
  .blob.a{width:520px;height:520px;left:-120px;top:-120px;background:conic-gradient(from 130deg,var(--mint),var(--vio),var(--blue));border-radius:60% 40% 55% 45%/60% 45% 55% 40%;animation:blob 18s ease-in-out infinite}
  .blob.b{width:420px;height:420px;right:-80px;bottom:-80px;background:conic-gradient(from 230deg,var(--accent),var(--accent2),var(--blue));border-radius:48% 52% 44% 56%/50% 46% 54% 50%;animation:blob 22s ease-in-out infinite reverse}
  @keyframes blob{0%,100%{transform:translate(0,0) rotate(0)}50%{transform:translate(24px,-20px) rotate(38deg)}}

  .app{position:relative;display:grid;grid-template-rows:auto auto 1fr auto;gap:14px;height:100vh;padding:16px}

  /* Nav Tabs （待機/表現/順番出し/結果）*/
  .stages{display:flex;gap:10px;background:var(--glass);border:1px solid var(--glass2);backdrop-filter:blur(10px);border-radius:18px;padding:8px;box-shadow:var(--shadow)}
  .stage{appearance:none;border:0;cursor:pointer;font-weight:900;padding:10px 14px;border-radius:12px;color:#111;background:#fff;box-shadow:0 6px 0 rgba(0,0,0,.28)}
  .stage.ghost{background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.2);box-shadow:none}
  .stage.active{background:linear-gradient(135deg,var(--mint),#86f2e2);color:#081214}

  /* Round Bar */
  .roundbar{display:flex;align-items:center;gap:10px;background:var(--glass);border:1px solid var(--glass2);backdrop-filter:blur(10px);border-radius:18px;padding:10px 14px;box-shadow:var(--shadow)}
  .round-title{font-weight:900}
  .actions{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
  .btn{appearance:none;border:none;border-radius:14px;padding:10px 12px;font-weight:800;letter-spacing:.2px;cursor:pointer;transition:transform .1s ease}
  .btn:active{transform:translateY(2px)}
  .btn.solid{background:linear-gradient(135deg,var(--accent),#ff7e75);color:#1a0f0f;box-shadow:0 6px 0 rgba(0,0,0,.28)}
  .btn.ghost{background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.2)}

  /* Main 3 columns */
  .content{display:grid;grid-template-columns:300px 1fr 320px;gap:14px;min-height:0}
  @media(max-width:1200px){.content{grid-template-columns:260px 1fr 280px}}
  @media(max-width:980px){.content{grid-template-columns:1fr;grid-auto-rows:auto}}

  .panel{background:var(--glass);border:1px solid var(--glass2);backdrop-filter:blur(10px);border-radius:var(--radius);box-shadow:var(--shadow);min-height:160px}
  .panel-header{display:flex;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px dashed rgba(255,255,255,.09)}
  .panel-title{font-weight:900}
  .panel-body{padding:12px 14px}

  /* Left: players & options */
  .players{display:grid;gap:10px;padding:10px 12px 14px}
  .player{display:flex;align-items:center;gap:12px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.14);padding:10px;border-radius:16px}
  .avatar{width:36px;height:36px;border-radius:12px;display:grid;place-items:center;color:#111;font-weight:900;background:linear-gradient(135deg,var(--accent2),#fff)}
  .status{margin-left:auto;font-size:12px;padding:4px 8px;border-radius:999px;background:rgba(48,227,202,.2);border:1px solid rgba(48,227,202,.35);color:#b9fff0}
  .options{display:grid;gap:12px;padding:10px 12px 16px}
  .opt-row{display:flex;gap:10px;align-items:center}
  .toggle{display:inline-flex;gap:8px}
  .radio{border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.1);padding:8px 10px;border-radius:999px;cursor:pointer}
  .radio.active{background:linear-gradient(135deg,var(--mint),#87f1e4);color:#0d1518}
  .danger{background:linear-gradient(135deg,#ff6b6b,#ff2b2b);color:#2b0707;border:none}

  /* Center: common screen */
  .board{display:grid;grid-template-rows:auto 1fr auto;min-height:0}
  .topic{margin:12px;display:flex;align-items:center;justify-content:space-between;gap:10px;border-radius:18px;padding:12px 14px;background:linear-gradient(120deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.16)}
  .topic h1{margin:6px 0;font-size:26px;letter-spacing:.02em}
  .topic small{opacity:.85;color:var(--muted);font-weight:700}

  .result-banner{margin:0 12px 6px;display:none}
  .result-banner.fail{display:block;color:#ffc9c9;font-weight:900;font-size:28px;text-align:center;text-shadow:0 2px 0 #a82a2a}
  .result-banner.success{display:block;color:#c2ffd6;font-weight:900;font-size:28px;text-align:center;text-shadow:0 2px 0 #2a8a4a}

  .surface{position:relative;display:grid;place-items:center;margin:0 12px 12px;border-radius:20px;border:1px dashed rgba(255,255,255,.16);background:
    repeating-linear-gradient(45deg, rgba(255,255,255,.04) 0 14px, rgba(255,255,255,.06) 14px 28px),
    linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.07));
    overflow:hidden;min-height:clamp(520px,65vh,880px)}
  .surface .label{position:absolute;top:8px;left:12px;font-size:12px;opacity:.7}
  .slot-wrap{display:flex;gap:14px;flex-wrap:wrap;justify-content:center;padding:38px}
  .slot{width:150px;height:190px;border-radius:18px;background:linear-gradient(135deg,#141b2d,#0b111f);border:1px solid rgba(255,255,255,.16);box-shadow:0 22px 32px rgba(0,0,0,.36);display:grid;place-items:center;position:relative}
  .card{width:112px;height:160px;border-radius:16px;background:linear-gradient(135deg,#fff,#f1f6ff);color:#131720;display:grid;place-items:center;font-weight:900;font-size:34px;box-shadow:0 14px 24px rgba(0,0,0,.25)}
  .badge{position:absolute;top:8px;left:8px;font-size:12px;padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.7);color:#111;font-weight:900}
  .owner{position:absolute;bottom:8px;left:0;right:0;text-align:center;font-size:12px;opacity:.9;color:#bcd3ff}
  .slot.fail{outline:3px solid rgba(255,93,87,.85)}

  .board-footer{display:flex;align-items:center;justify-content:flex-end;padding:10px 12px;border-top:1px dashed rgba(255,255,255,.1)}

  .deck{position:absolute;left:16px;bottom:16px;width:120px;height:84px;display:grid;place-items:center}
  .stack{position:absolute;width:86px;height:126px;border-radius:14px;background:linear-gradient(135deg,#fff,#eef2ff);box-shadow:0 12px 20px rgba(0,0,0,.25);transform:translate(var(--x,0),var(--y,0)) rotate(var(--r,0deg))}
  .stack:nth-child(1){--x:-12px;--y:-8px;--r:-6deg;opacity:.6}
  .stack:nth-child(2){--x:6px;--y:4px;--r:4deg;opacity:.8}
  .stack:nth-child(3){--x:0;--y:0;--r:0deg}
  .deck .label{position:absolute;bottom:-2px;left:0;font-size:11px;opacity:.75}
  .fly{position:fixed;z-index:120;width:86px;height:126px;border-radius:14px;background:linear-gradient(135deg,#fff,#eef2ff);box-shadow:0 14px 24px rgba(0,0,0,.3);transition:transform .45s cubic-bezier(.2,.7,.2,1),opacity .45s}

  /* Right: chat */
  .chat{display:grid;grid-template-rows:auto 1fr auto}
  .chat-list{padding:10px 12px;display:flex;flex-direction:column;gap:10px;overflow:auto}
  .bubble{max-width:85%;padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.08)}
  .bubble.me{margin-left:auto;background:linear-gradient(135deg,var(--mint),#88f0e5);color:#062022}
  .chat-input{display:flex;gap:10px;padding:10px 12px;border-top:1px dashed rgba(255,255,255,.1)}
  .input{flex:1;border:none;border-radius:12px;padding:12px 14px;background:rgba(255,255,255,.12);color:#fff;outline:none}

  /* Bottom: my number & hint */
  .dock{display:grid;grid-template-columns:420px 1fr 320px;gap:14px}
  @media(max-width:980px){.dock{grid-template-columns:1fr;grid-auto-rows:auto}}
  .mycard{display:flex;align-items:center;gap:14px;background:var(--glass);border:1px solid var(--glass2);border-radius:var(--radius);padding:12px 14px;box-shadow:var(--shadow)}
  .pill{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:8px 12px;background:linear-gradient(135deg,var(--accent),#ff7e75);color:#1b0e0e;font-weight:900;box-shadow:0 8px 18px rgba(255,93,87,.35)}
  .card3d{position:relative;width:96px;height:140px;perspective:1000px}
  .card3d .face{position:absolute;inset:0;border-radius:14px;display:grid;place-items:center;font-weight:900;font-size:32px;backface-visibility:hidden}
  .card3d .front{background:linear-gradient(135deg,#0f1527,#0a0f20);border:1px solid rgba(255,255,255,.14);color:#9fb4ff}
  .card3d .back{background:linear-gradient(135deg,#fff,#f1f5ff);color:#0b0f16;transform:rotateY(180deg)}
  .card3d.flip .front{transform:rotateY(180deg)}
  .card3d.flip .back{transform:rotateY(0)}
  .hintbox{display:flex;gap:10px;align-items:center}

  /* Overlays */
  .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(8,12,18,.55);backdrop-filter:blur(4px);z-index:200}
  .overlay.open{display:flex}
  .badge-big{padding:22px 34px;border-radius:22px;font-weight:900;font-size:64px;letter-spacing:.06em;box-shadow:0 18px 30px rgba(0,0,0,.35)}
  .ok{background:linear-gradient(135deg,#4af58b,#2ecc71);color:#05250f}
  .ng{background:linear-gradient(135deg,#ff6b6b,#ff2b2b);color:#2b0707;animation:shake .45s}
  @keyframes shake{10%,90%{transform:translateX(-2px)}20%,80%{transform:translateX(4px)}30%,50%,70%{transform:translateX(-8px)}40%,60%{transform:translateX(8px)}}

  canvas#confetti{position:fixed;inset:0;pointer-events:none;z-index:220}
  *{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.25) transparent}
  *::-webkit-scrollbar{height:8px;width:8px}
  *::-webkit-scrollbar-thumb{background:rgba(255,255,255,.25);border-radius:999px}
</style>
</head>
<body>
<div class="blob a"></div><div class="blob b"></div>
<canvas id="confetti"></canvas>
<div class="app">
  <!-- Stage tabs -->
  <div class="stages" id="stageTabs">
    <button class="stage active" data-stage="wait">待機</button>
    <button class="stage ghost" data-stage="express">表現</button>
    <button class="stage ghost" data-stage="order">順番出し</button>
    <button class="stage ghost" data-stage="result">結果</button>
  </div>

  <!-- Round Bar -->
  <div class="roundbar">
    <div class="round-title" id="roundLabel">ラウンド1 | カテゴリ: 未選択</div>
    <div class="actions">
      <button class="btn ghost" id="btnCategory">カテゴリ変更</button>
      <button class="btn solid" id="btnDeal">数字を配る</button>
    </div>
  </div>

  <!-- Three columns -->
  <div class="content">
    <!-- Left -->
    <section class="panel">
      <div class="panel-header"><div class="panel-title">参加人数: <span id="playerCount" class="tag"></span></div></div>
      <div class="players" id="players"></div>
      <div class="panel-header"><div class="panel-title">オプション</div></div>
      <div class="options">
        <div class="opt-row"><div>クリア方式 (resolveMode)</div></div>
        <div class="opt-row toggle" id="resolveMode">
          <span class="radio active" data-mode="sequential">順番に出す</span>
          <span class="radio" data-mode="all">せーので出す</span>
        </div>
        <div class="opt-row">
          <button class="btn ghost" id="btnReset">リセット</button>
          <button class="btn danger" id="btnRetry">もう一度</button>
        </div>
      </div>
    </section>

    <!-- Center -->
    <section class="panel board">
      <div class="topic">
        <div>
          <small>ラウンド<span id="roundNum">1</span> | カテゴリ: <span id="category">未選択</span></small>
          <h1 id="topicTitle">ゲーム開始後にお題を選択できます</h1>
        </div>
      </div>
      <div id="resultBanner" class="result-banner"></div>
      <div class="surface">
        <span class="label">カードボード（出した順）</span>
        <div class="slot-wrap" id="slots"></div>
        <div class="deck" id="deck">
          <div class="stack"></div>
          <div class="stack"></div>
          <div class="stack"></div>
          <div class="label">DECK</div>
        </div>
      </div>
      <div class="board-footer">
        <small class="tag">昇順が崩れた場所を赤い枠で表示します</small>
      </div>
    </section>

    <!-- Right -->
    <section class="panel chat">
      <div class="panel-header"><div class="panel-title">ログ / チャット</div></div>
      <div class="chat-list" id="chat"></div>
      <div class="chat-input"><input id="chatInput" class="input" placeholder="メッセージを入力"/><button class="btn solid" id="chatSend">送信</button></div>
    </section>
  </div>

  <!-- Bottom Dock -->
  <div class="dock">
    <div class="mycard">
      <span class="pill">あなたの数字（自分にだけ表示）</span>
      <div class="card3d" id="myCard">
        <div class="face front">？</div>
        <div class="face back" id="myNum">--</div>
      </div>
    </div>
    <div class="mycard hintbox">
      <div class="pill" style="background:linear-gradient(135deg,var(--blue),#86bfff);color:#061523">連想</div>
      <input id="hint" class="input" placeholder="連想（いつでも変更可）"/>
      <button class="btn ghost" id="hintUpdate">更新</button>
    </div>
    <button class="btn solid" id="btnSubmit" style="justify-self:end">この順で出す / せーので判定</button>
  </div>
</div>

<!-- Overlay Result -->
<div class="overlay" id="overlay"><div id="overlayBadge" class="badge-big ok">成功！</div></div>

<script>
// ====== 状態 ======
const state={
  stage:'wait',
  resolveMode:'sequential',
  round:1,
  category:'未選択',
  topic:'',
  players:[
    {id:'p1',name:'ああ',color:'#ffd166'},
    {id:'p2',name:'chrome通常',color:'#7af1de'},
    {id:'p3',name:'エッジです。',color:'#8ac2ff'}
  ],
  myId:'p2',
  deck:Array.from({length:100},(_,i)=>i+1),
  nums:{},
  board:[],
  chat:[]
};

const el={
  stageTabs:document.getElementById('stageTabs'),
  roundLabel:document.getElementById('roundLabel'),
  players:document.getElementById('players'),
  playerCount:document.getElementById('playerCount'),
  slots:document.getElementById('slots'),
  deck:document.getElementById('deck'),
  topicTitle:document.getElementById('topicTitle'),
  category:document.getElementById('category'),
  resultBanner:document.getElementById('resultBanner'),
  myCard:document.getElementById('myCard'),
  myNum:document.getElementById('myNum'),
  overlay:document.getElementById('overlay'),
  overlayBadge:document.getElementById('overlayBadge'),
  chat:document.getElementById('chat'),
  chatInput:document.getElementById('chatInput')
};

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a}

// ====== レンダ ======
function renderPlayers(){
  el.players.innerHTML='';
  state.players.forEach(p=>{
    const row=document.createElement('div');row.className='player';
    row.innerHTML=`<div class="avatar" style="background:linear-gradient(135deg, ${p.color}, #fff)">${p.name.slice(0,1)}</div>
      <div><div style="font-weight:800">${p.name}</div><div class="tag">連携: 参加中</div></div>
      <span class="status">在室</span>`;
    el.players.appendChild(row);
  });
  document.getElementById('playerCount').textContent=`${state.players.length}/${state.players.length}`;
}

function renderBoard(){
  el.slots.innerHTML='';
  const n=Math.max(6,state.players.length);
  for(let i=0;i<n;i++){
    const s=document.createElement('div');s.className='slot';
    const c=document.createElement('div');c.className='card';c.textContent=state.board[i]??'?';
    const b=document.createElement('div');b.className='badge';b.textContent=`#${i+1}`;
    const o=document.createElement('div');o.className='owner';o.textContent=state.players[i%state.players.length]?.name||'';
    s.append(c,b,o);el.slots.appendChild(s);
  }
}

function pushChat(t,me=false){
  state.chat.push({t,me});
  const b=document.createElement('div');b.className='bubble'+(me?' me':'');b.textContent=t;el.chat.appendChild(b);el.chat.scrollTop=el.chat.scrollHeight;
}

// ====== 配る演出 ======
function fly(from,to,cb){
  const f=document.createElement('div');f.className='fly';document.body.appendChild(f);
  const fr=from.getBoundingClientRect();const tr=to.getBoundingClientRect();
  const sx=fr.left+fr.width/2-43,sy=fr.top+fr.height/2-63;const tx=tr.left+tr.width/2-43,ty=tr.top+tr.height/2-63;
  f.style.transform=`translate(${sx}px,${sy}px)`;
  requestAnimationFrame(()=>{f.style.transform=`translate(${tx}px,${ty}px)`;f.style.opacity=.9});
  f.addEventListener('transitionend',()=>{f.remove();cb&&cb()}, {once:true});
}

function deal(){
  const deck=shuffle([...state.deck]);
  state.players.forEach((p,i)=>state.nums[p.id]=deck[i]);
  const me=state.players.find(p=>p.id===state.myId);
  const avatars=[...document.querySelectorAll('.player .avatar')];
  avatars.forEach((av,i)=>setTimeout(()=>{
    fly(el.deck,av,()=>{
      if(state.players[i].id===state.myId){
        el.myNum.textContent=state.nums[me.id];el.myCard.classList.add('flip');
      }
    });
  },i*180));
  pushChat('数字を配りました（ヒントで伝えてね）');
  state.category=state.category==='未選択'?'クラシック版':state.category;el.category.textContent=state.category;document.getElementById('roundLabel').textContent=`ラウンド${state.round} | カテゴリ: ${state.category}`;
  if(!state.topic){state.topic='芸人になって考えよう ヤバい罰ゲーム';el.topicTitle.textContent=state.topic;}
}

// ====== 判定 ======
function judgeSequential(){
  // デモ: 全員分を自動で出して判定
  const nums=state.players.map(p=>state.nums[p.id]);
  const asc=[...nums].sort((a,b)=>a-b);
  state.board=[...nums];
  renderBoard();
  // 失敗位置を検出
  let failIndex=-1;for(let i=1;i<state.board.length;i++){if(state.board[i]<state.board[i-1]){failIndex=i;break}}
  if(failIndex>=0){markFail(failIndex);banner(false,`失敗！昇順が崩れました（#${failIndex+1} 枚目）`)}else{banner(true,'成功！');confetti()}
}

function judgeAll(){
  // デモ: ソートしてから公開
  const nums=state.players.map(p=>state.nums[p.id]);
  state.board=[...nums].sort((a,b)=>a-b);renderBoard();banner(true,'成功！ せーので公開！');confetti();
}

function markFail(idx){
  const slot=el.slots.children[idx]; if(slot) slot.classList.add('fail');
}

function banner(ok,msg){
  el.resultBanner.className='result-banner '+(ok?'success':'fail');el.resultBanner.textContent=msg;
  showOverlay(ok);
}

// ====== 演出 ======
const canvas=document.getElementById('confetti');const ctx=canvas.getContext('2d');const dpr=window.devicePixelRatio||1;
function size(){canvas.width=innerWidth*dpr;canvas.height=innerHeight*dpr;ctx.setTransform(dpr,0,0,dpr,0,0)}size();addEventListener('resize',size);
function confetti(){const pieces=Array.from({length:140},()=>({x:Math.random()*innerWidth,y:-20-Math.random()*40,r:4+Math.random()*6,s:2+Math.random()*3,a:1,color:['#ffd166','#ff5d57','#7af1de','#8ac2ff','#9b6cff'][Math.floor(Math.random()*5)]}));const start=performance.now();(function loop(now){ctx.clearRect(0,0,innerWidth,innerHeight);pieces.forEach(p=>{p.y+=p.s;p.x+=Math.sin((p.y+p.r)*.05);p.a-=.008;ctx.globalAlpha=Math.max(p.a,0);ctx.fillStyle=p.color;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();});ctx.globalAlpha=1;if(now-start<1200)requestAnimationFrame(loop)})(start)}
function showOverlay(ok){const o=document.getElementById('overlay'),b=document.getElementById('overlayBadge');o.classList.add('open');b.className='badge-big '+(ok?'ok':'ng');b.textContent=ok?'成功！':'失敗です！！';setTimeout(()=>o.classList.remove('open'),1400)}

// ====== イベント ======
// tabs
el.stageTabs.addEventListener('click',e=>{const t=e.target.closest('.stage');if(!t)return;document.querySelectorAll('.stage').forEach(s=>s.classList.add('ghost'));t.classList.remove('ghost');document.querySelectorAll('.stage').forEach(s=>s.classList.remove('active'));t.classList.add('active');state.stage=t.dataset.stage;});
// resolve mode
const mode=document.getElementById('resolveMode');mode.addEventListener('click',e=>{const r=e.target.closest('.radio');if(!r)return;document.querySelectorAll('#resolveMode .radio').forEach(x=>x.classList.remove('active'));r.classList.add('active');state.resolveMode=r.dataset.mode});
// buttons
document.getElementById('btnDeal').onclick=deal;
document.getElementById('btnReset').onclick=()=>{state.board=[];renderBoard();el.resultBanner.textContent='';el.resultBanner.className='result-banner'};
document.getElementById('btnRetry').onclick=()=>{state.round++;state.board=[];renderBoard();el.resultBanner.textContent='';el.resultBanner.className='result-banner';document.getElementById('roundLabel').textContent=`ラウンド${state.round} | カテゴリ: ${state.category}`};
document.getElementById('btnCategory').onclick=()=>{state.category=state.category==='クラシック版'?'レインボー版':'クラシック版';el.category.textContent=state.category;document.getElementById('roundLabel').textContent=`ラウンド${state.round} | カテゴリ: ${state.category}`}

document.getElementById('btnSubmit').onclick=()=>{state.resolveMode==='sequential'?judgeSequential():judgeAll()};

// chat
function sendChat(){const v=el.chatInput.value.trim();if(!v)return;pushChat(v,true);el.chatInput.value=''}
document.getElementById('chatSend').onclick=sendChat;el.chatInput.addEventListener('keydown',e=>{if(e.key==='Enter')sendChat()});

// init
function init(){renderPlayers();renderBoard();pushChat('ようこそ！カテゴリを選んで「数字を配る」を押してね')}init();
</script>
</body>
</html>
