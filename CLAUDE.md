# 🎯 Claude Code 指示書

## 📋 **メイン ミッション**

**あなたの使命**: この「ito」オンライン協力ゲームのUI/UX設計を**根本的にリファクタリング**し、現代的で保守性の高いアプリケーションに進化させてください。

## 📚 **必読資料**

### **最優先参照ファイル**

- **`CLAUDE.md`** ← この指示書（現在のファイル）
- [docs/itorule.md](docs/itorule.md) ゲームルール仕様（変更禁止）
- **`d`** ← この指示書（現在のファイル）

わからないことあればgpt5-searchをつかってね。

次の指示案（優先順位順）

1. レスポンシブ設計の改善（最優先）
   モバイルアクセシビリティの問題を解決してください：

現在の問題：

- `display={{ base: "none", md: "flex" }}` でモバイルでサイドバー・右パネルが完全非表示
- モバイルユーザーが参加者リストやチャットにアクセス不可

解決方針：

1. モバイル用ボトムシート実装
2. ハンバーガーメニューでサイドバーアクセス
3. スワイプ操作でチャットパネル表示
4. タブ切り替えでコンテンツ表示

技術制約：

- UNIFIED_LAYOUTシステム活用
- framer-motionでスムーズなアニメーション
- アクセシビリティ配慮（aria-label、focus管理）

2. minH={0}の最適化
   Flexboxレイアウトの根本的改善を実施してください：

現在の問題：

- 10箇所でminH={0}を使用（一時的回避策）
- Flexbox overflow問題の根本解決が必要

改善方針：

1. flex-shrink: 0 の適切な使用
2. overflow: hidden の戦略的配置
3. 高さ計算の明示的制御
4. minH={0}の段階的削除

目標：minH={0}使用箇所を5箇所以下に削減3. 廃止予定システムの移行
レガシーレイアウトシステムから新システムへの完全移行：

移行対象：

- UNIFIED_LAYOUT.BORDER_WIDTH (25箇所以上)
- PREDICTABLE_LAYOUT → UNIFIED_LAYOUT
- DPI_ADAPTIVE_LAYOUT → UNIFIED_LAYOUT

移行方針：

1. getBorderWidth() ヘルパー関数の活用
2. コンテキストアウェアなborder管理
3. elevation システムの積極活用
4. 段階的移行でリスク軽減
   💡 推奨する次の指示
   最優先は「レスポンシブ設計の改善」です。理由：

ユーザビリティに直接影響
モバイルユーザーのアクセシビリティ問題
ゲームの協力要素（チャット・参加者確認）が重要
Claude Codeに以下のように伝えることをお勧めします：

次のミッション：モバイルアクセシビリティの完全解決

現在モバイルユーザーがサイドバー・右パネルにアクセスできない問題を解決してください。ボトムシート、ハンバーガーメニュー、スワイプ操作を実装し、全デバイスで快適なゲーム体験を提供してください。

詳細指示をCLAUDE.mdに追記してもらえますか？

---

## 🚨 **重要: テーマシステム決定事項**

### **ライトモード固定決定**

**2025-08-27に完了**: このプロジェクトは**ライトモード専用**に確定しました。

#### **重要な決定理由**
- 協力ゲームの性質上、明るく親しみやすい UI が最適
- 入力フィールドの可読性問題を根本解決
- 保守性の向上（テーマ切り替えロジック除去）
- 今後のエージェント作業での一貫性確保

#### **⚠️ 将来のエージェント向け重要警告**

**絶対に以下を行わないでください:**

1. **`_dark` プロパティの再導入**
   - すべて除去済み。再追加は UI 破綻を引き起こします
   - `theme/index.ts`, `theme/recipes/*.ts` から完全除去済み

2. **ダークモード機能の復活**
   - `next-themes` プロバイダーは意図的に除去済み
   - `ThemeToggle` コンポーネントは無効化済み

3. **条件付きテーマトークンの使用**
   ```typescript
   // ❌ 絶対に使用禁止
   bg: { base: "white", _dark: "gray.900" }
   
   // ✅ 正しい形式（ライトモード固定）
   bg: "white"
   ```

#### **現在の実装状態**
- ✅ `theme/index.ts`: 全semantic tokensからライトモード専用に変更
- ✅ `theme/recipes/button.recipe.ts`: 全variantからライトモード専用
- ✅ `components/site/Hero.tsx`: bgGradientライトモード固定  
- ✅ `components/site/LobbySkeletons.tsx`: skeleton colorライトモード固定
- ✅ `app/providers.tsx`: LightModeOnlyBridge実装
- ✅ `components/site/ThemeToggle.tsx`: 機能無効化済み

#### **質問時の対応**
もしユーザーからダークモード関連の要求があった場合:

1. この決定事項セクションを参照
2. ライトモード固定の理由を説明  
3. UI破綻リスクを警告
4. 代替提案（アクセシビリティ向上など）を提示

**この決定は最終確定です。変更には十分な理由が必要です。**

