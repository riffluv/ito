# ロビー周り検証 指示書（Codex向け）

## 概要
本指示書は、HD2D風カードゲームの「ロビー機能」において、**入室 / 退室処理**、**参加者一覧の同期**、**waitingカード表示**が一貫して正しく動作しているかを検証するための依頼内容をまとめたものです。  
Codexは内部プログラムの状態管理やソケット通信処理に強いため、以下の観点をもとに実装検証を行うことを目的とします。

---

## 検証対象
- **入室処理**
- **退室処理**
- **参加者一覧の同期**
- **waitingカードの表示**
- **再接続（リロード）時の同期**

---

## 詳細チェックポイント

### 1. 入室処理
- プレイヤーがルームに入室したとき、必ず参加者一覧に反映されること。
- 入室したのに参加者一覧に表示されない、またはゲームから除外される不具合が発生しないこと。

### 2. 退室処理
- プレイヤーがルームを退出したとき、必ず参加者一覧から削除されること。
- 退室後も残ってしまう「ゴーストプレイヤー」が存在しないこと。

### 3. 参加者一覧の同期
- 全てのクライアントで参加者一覧が正しく同期されていること。
- 他プレイヤーが入室/退室した際に、即時かつ正確に反映されること。

### 4. Waitingカードの表示
- 入室中のプレイヤーごとに、必ず対応するwaitingカードが下部に表示されること。  
  （例: 参加者人数分のカードが整列する）
- 入室しているのにwaitingカードが表示されない、または退室後にwaitingカードが残る不具合が起きないこと。

### 5. 再接続（リロード）時の同期
- プレイヤーがブラウザをリロード、あるいは再接続した場合に、参加者一覧とwaitingカードが正しく復元されること。
- 不整合が起きず、既存プレイヤーの状態とサーバー側の状態が一致すること。

---

## 補足
- waitingカードとは：自分の手札以外に、**参加者人数分のカードが下部に並んで表示される要素**を指す。
- 本チェックはサーバーイベント処理（connect / disconnect / state同期）とUIレンダリングの両面にまたがるため、**内部処理とUI表示の一致**を必ず確認すること。

---

## 成果物（期待するアウトプット）
- 入室 / 退室 / 同期処理が正しく動作しているかの検証ログまたはテストコード。
- 不具合がある場合は、再現手順・原因の仮説・改善提案を明示。

---

以上の観点をもとに、ロビー周りの完全性を検証してください。
